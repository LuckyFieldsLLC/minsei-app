import{r,j as e,C as ve,t as Ce,u as Ie,v as _,m as F,B as ke,w as Ae,x as De,y as Se,e as Ee,d as Oe,A as u,z as X,k as Ge,H as Pe,i as $e,E as Re,T as _e,U as Fe,F as Ke,l as Le}from"./index-DWy39khm.js";const Y=[{name:"blue",bgClass:"bg-theme-blue"},{name:"pink",bgClass:"bg-theme-pink"},{name:"green",bgClass:"bg-theme-green"},{name:"purple",bgClass:"bg-theme-purple"},{name:"orange",bgClass:"bg-theme-orange"}],Ue=[{key:"xs",label:"極小"},{key:"sm",label:"小"},{key:"base",label:"中"},{key:"lg",label:"大"}],Z=d=>e.jsx("svg",{...d,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),b=({title:d,description:c,children:g,defaultOpen:t=!1})=>{const[j,m]=r.useState(t);return e.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white shadow-sm",children:[e.jsxs("button",{onClick:()=>m(!j),className:"w-full flex justify-between items-center p-3 text-left font-semibold text-gray-800 bg-gray-50/70 hover:bg-gray-100",children:[e.jsx("span",{children:d}),e.jsx(Le,{className:`h-5 w-5 transition-transform ${j?"rotate-180":""}`})]}),j&&e.jsxs("div",{className:"p-4 border-t",children:[c&&e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:c}),e.jsx("div",{className:"space-y-4",children:g})]})]})},y=({icon:d,label:c,description:g,onClick:t,children:j,disabled:m})=>e.jsxs("div",{className:`border p-4 rounded-lg transition-colors ${m?"bg-gray-100":"hover:bg-gray-50"}`,children:[e.jsxs("button",{onClick:t,className:"w-full flex items-center text-left",disabled:m,children:[e.jsx("div",{className:`p-2 rounded-lg ${m?"bg-gray-300 text-gray-500":"bg-brand-lightblue text-brand-blue"}`,children:d}),e.jsxs("div",{className:"ml-4 flex-grow",children:[e.jsx("p",{className:`font-semibold ${m?"text-gray-500":"text-gray-800"}`,children:c}),e.jsx("p",{className:`text-sm ${m?"text-gray-500":"text-gray-600"}`,children:g})]})]}),j]}),k=({name:d,value:c,label:g,checked:t,onChange:j})=>e.jsxs("label",{className:`flex-1 text-center p-2 rounded-md cursor-pointer transition-colors text-sm ${t?"bg-brand-blue text-white":"bg-white text-black shadow-sm"}`,children:[e.jsx("input",{type:"radio",name:d,value:c,checked:t,onChange:()=>j(c),className:"sr-only"}),g]}),Ve=({icon:d,label:c,isActive:g,onClick:t})=>e.jsxs("button",{onClick:t,className:`w-full flex items-center p-2 text-sm font-medium rounded-md text-left transition-colors whitespace-nowrap ${g?"bg-brand-lightblue text-brand-blue":"text-gray-600 hover:bg-gray-100"}`,children:[d,e.jsx("span",{className:"ml-3 hidden md:inline",children:c})]}),ze=({isOpen:d,onClose:c,initialTab:g,profile:t,onSaveProfile:j,districts:m,onSaveDistricts:A,settings:s,onSaveSettings:ee,onCropProfileImage:ae,onCropAppIcon:se,onBackup:le,onRestore:te,installPrompt:re,onInstall:ne,onExport:ie,onOpenImportModal:de,isGoogleSignedIn:N,gapiAuthInstance:D,onGoogleSignIn:oe,onGoogleSignOut:ce,onBackupToDrive:me,onRestoreFromDrive:xe,driveBackupStatus:f,peopleWithFollowUp:K,onAddToCalendar:he})=>{const[L,U]=r.useState(g),[S,V]=r.useState(""),[ge,M]=r.useState(null),[z,E]=r.useState(""),[O,T]=r.useState(""),[G,B]=r.useState(""),[P,be]=r.useState(!1),[$,ue]=r.useState(!1),[R,w]=r.useState(!1),[v,C]=r.useState({}),H=r.useRef(null),q=r.useRef(null),J=r.useRef(null);if(r.useEffect(()=>{U(g)},[g,d]),r.useEffect(()=>{d&&(T(localStorage.getItem("gemini_api_key")||""),B(localStorage.getItem("openai_api_key")||""))},[d]),r.useEffect(()=>{localStorage.setItem("gemini_api_key",O.trim())},[O]),r.useEffect(()=>{localStorage.setItem("openai_api_key",G.trim())},[G]),!d)return null;const i=l=>{j({...t,[l.target.name]:l.target.value})},n=(l,o)=>{ee({...s,[l]:o})},Q=(l,o)=>{const x=new FileReader;x.onload=I=>{var a;typeof((a=I.target)==null?void 0:a.result)=="string"&&o(I.target.result)},x.readAsDataURL(l)},je=l=>{var o;(o=l.target.files)!=null&&o[0]&&te(l.target.files[0])},pe=()=>{S.trim()&&(A([...m,{id:Date.now(),name:S.trim()}]),V(""))},W=l=>{A(m.map(o=>o.id===l?{...o,name:z.trim()}:o)),M(null),E("")},ye=l=>{window.confirm("この地区を削除しますか？所属するレコードは「未割り当て」になります。")&&A(m.filter(o=>o.id!==l))},Ne=l=>{M(l.id),E(l.name)},fe=()=>{switch(L){case"profile":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-24 h-24",children:[t.photo?e.jsx("img",{src:t.photo,alt:"プロフィール写真",className:"w-24 h-24 rounded-full object-cover"}):e.jsx(Fe,{className:"w-24 h-24 text-gray-300"}),e.jsxs("button",{onClick:()=>{var a;return(a=H.current)==null?void 0:a.click()},className:"absolute bottom-0 right-0 bg-white p-1.5 rounded-full shadow border hover:bg-gray-100",children:[e.jsx(Ke,{className:"w-5 h-5 text-gray-600"}),e.jsx("input",{type:"file",ref:H,onChange:a=>{var h;return((h=a.target.files)==null?void 0:h[0])&&Q(a.target.files[0],ae)},accept:"image/*",className:"hidden"})]})]}),e.jsxs("div",{className:"flex-grow space-y-2",children:[e.jsx("input",{type:"text",name:"name",value:t.name,onChange:i,placeholder:"氏名",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"}),e.jsx("input",{type:"text",name:"furigana",value:t.furigana,onChange:i,placeholder:"ふりがな",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-2",children:"所属・担当エリア"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"organization",value:t.organization||"",onChange:i,placeholder:"所属団体名",className:"w-full p-2 border border-gray-300 rounded-md md:col-span-2 bg-white text-gray-900"}),e.jsx("input",{type:"text",name:"prefecture",value:t.prefecture||"",onChange:i,placeholder:"県",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"}),e.jsx("input",{type:"text",name:"municipality",value:t.municipality||"",onChange:i,placeholder:"自治体（市町村）",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{type:"text",name:"region",value:t.region||"",onChange:i,placeholder:"地域・地区名",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"title",value:t.title,onChange:i,placeholder:"役職 (例: 民生委員・児童委員)",className:"w-full p-2 border border-gray-300 rounded-md md:col-span-2 bg-white text-gray-900"}),e.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:i,placeholder:"電話番号",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:i,placeholder:"メールアドレス",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"自己紹介・メモ"}),e.jsx("textarea",{name:"bio",value:t.bio||"",onChange:i,placeholder:"AIがあなたを認識するための簡単な自己紹介など",rows:3,className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"担当地区の概要"}),e.jsx("textarea",{name:"areaOfResponsibility",value:t.areaOfResponsibility||"",onChange:i,placeholder:"担当している地区の特徴や注意点など",rows:3,className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"生年月日"}),e.jsx("input",{type:"date",name:"dob",value:t.dob||"",onChange:i,className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"性別"}),e.jsxs("select",{name:"gender",value:t.gender||"",onChange:i,className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900",children:[e.jsx("option",{value:"",children:"選択してください"}),e.jsx("option",{value:"男性",children:"男性"}),e.jsx("option",{value:"女性",children:"女性"}),e.jsx("option",{value:"その他",children:"その他"}),e.jsx("option",{value:"無回答",children:"無回答"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"任期開始日"}),e.jsx("input",{type:"date",name:"termStartDate",value:t.termStartDate||"",onChange:i,className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"任期終了日"}),e.jsx("input",{type:"date",name:"termEndDate",value:t.termEndDate||"",onChange:i,className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"})]})]})]});case"districts":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"地区の追加"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("input",{type:"text",value:S,onChange:a=>V(a.target.value),placeholder:"新しい地区名",className:"flex-grow p-2 border border-gray-300 rounded-md bg-white text-gray-900"}),e.jsx("button",{onClick:pe,className:"p-2 bg-brand-blue text-white rounded-md hover:bg-blue-800",children:e.jsx($e,{className:"h-6 w-6"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"地区一覧"}),e.jsx("div",{className:"mt-2 space-y-2 max-h-60 overflow-y-auto border rounded-md p-2",children:m.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded-md",children:[ge===a.id?e.jsx("input",{type:"text",value:z,onChange:h=>E(h.target.value),className:"flex-grow p-1 border border-gray-300 rounded-md bg-white text-gray-900",autoFocus:!0,onBlur:()=>W(a.id),onKeyDown:h=>h.key==="Enter"&&W(a.id)}):e.jsx("span",{className:"flex-grow",children:a.name}),e.jsxs("div",{className:"flex gap-2 ml-2",children:[e.jsx("button",{onClick:()=>Ne(a),className:"text-gray-500 hover:text-brand-blue",children:e.jsx(Re,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>ye(a.id),className:"text-gray-500 hover:text-red-500",children:e.jsx(_e,{className:"h-5 w-5"})})]})]},a.id))})]})]});case"display":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{title:"アプリの基本設定",children:[e.jsx("input",{type:"text",value:s.appName,onChange:a=>n("appName",a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900"}),e.jsxs("div",{className:"relative flex items-center gap-4",children:[e.jsx("label",{className:"font-semibold",children:"アプリアイコン"}),s.customIcon?e.jsx("img",{src:s.customIcon,alt:"App Icon",className:"w-10 h-10 rounded-lg object-cover"}):e.jsx(Pe,{className:"w-10 h-10 text-gray-400 p-1 border rounded-lg"}),e.jsx("button",{onClick:()=>{var a;return(a=q.current)==null?void 0:a.click()},className:"text-sm text-brand-blue hover:underline",children:"アイコンを変更"}),e.jsx("input",{type:"file",ref:q,onChange:a=>{var h;return((h=a.target.files)==null?void 0:h[0])&&Q(a.target.files[0],se)},accept:"image/*",className:"hidden"})]})]}),e.jsxs(b,{title:"表示設定",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"男性のテーマカラー"}),e.jsx("div",{className:"flex gap-2 mt-1",children:Y.map(a=>e.jsx("button",{onClick:()=>n("maleColor",a.name),className:`w-8 h-8 rounded-full ${a.bgClass} ${s.maleColor===a.name?"ring-2 ring-offset-2 ring-brand-blue":""}`},a.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"女性のテーマカラー"}),e.jsx("div",{className:"flex gap-2 mt-1",children:Y.map(a=>e.jsx("button",{onClick:()=>n("femaleColor",a.name),className:`w-8 h-8 rounded-full ${a.bgClass} ${s.femaleColor===a.name?"ring-2 ring-offset-2 ring-brand-blue":""}`},a.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"文字サイズ"}),e.jsx("div",{className:"flex bg-gray-200 rounded-lg p-1 gap-1 mt-1",children:Ue.map(a=>e.jsx("button",{onClick:()=>n("fontSize",a.key),className:`flex-1 text-center p-2 rounded-md transition-colors text-sm ${s.fontSize===a.key?"bg-brand-blue text-white":"bg-white text-black shadow-sm"}`,children:a.label},a.key))})]})]}),e.jsxs(b,{title:"ダッシュボード設定",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-800 text-sm",children:"名簿カードに活動履歴を表示"}),e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:!!s.showCardActivityOnDashboard,onChange:()=>n("showCardActivityOnDashboard",!s.showCardActivityOnDashboard)}),e.jsx("div",{className:`block w-12 h-7 rounded-full transition-colors ${s.showCardActivityOnDashboard?"bg-brand-blue":"bg-gray-300"}`}),e.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform ${s.showCardActivityOnDashboard?"translate-x-full":""}`})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2 text-sm",children:"表示形式"}),e.jsxs("div",{className:"flex bg-gray-200 rounded-lg p-1",children:[e.jsx(k,{name:"view-style",value:"detail",label:"最新の履歴",checked:s.cardActivityStyleOnDashboard==="detail",onChange:a=>n("cardActivityStyleOnDashboard",a)}),e.jsx(k,{name:"view-style",value:"count",label:"活動件数",checked:s.cardActivityStyleOnDashboard==="count",onChange:a=>n("cardActivityStyleOnDashboard",a)})]})]})]}),re&&e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:ne,className:"w-full flex items-center justify-center gap-2 p-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:[e.jsx(X,{className:"h-5 w-5"}),"ホーム画面に追加"]})})]});case"data":return e.jsxs("div",{className:"space-y-4",children:[e.jsx(y,{icon:e.jsx(F,{className:"h-5 w-5"}),label:"CSVからインポート",description:"CSVファイルから名簿を一括登録します。",onClick:de}),e.jsx(y,{icon:e.jsx(X,{className:"h-5 w-5"}),label:"CSVへエクスポート",description:"現在の名簿をCSVファイルで書き出します。",onClick:ie}),e.jsx("div",{className:"border-t pt-4 mt-4"}),e.jsx(y,{icon:e.jsx(Ge,{className:"h-5 w-5"}),label:"バックアップを作成 (ファイル)",description:"全データをファイルに保存します。機種変更時に。",onClick:le}),e.jsx(y,{icon:e.jsx(F,{className:"h-5 w-5"}),label:"バックアップから復元 (ファイル)",description:"ファイルからデータを復元。現在のデータは上書きされます。",onClick:()=>{var a;return(a=J.current)==null?void 0:a.click()},children:e.jsx("input",{type:"file",ref:J,onChange:je,accept:".json",className:"hidden"})})]});case"ai":const l=s.aiProvider&&s.aiProvider!==u.NONE,o=()=>{if(l)n("aiProvider",u.NONE);else{const a=localStorage.getItem("gemini_api_key")||"",h=localStorage.getItem("openai_api_key")||"";if(!a.trim()&&!h.trim()){alert("AI連携を有効にするには、先にGeminiまたはOpenAIのAPIキーをこの画面で設定してください。");return}a.trim()?n("aiProvider",u.GEMINI):n("aiProvider",u.OPENAI)}};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{title:"AI連携設定",defaultOpen:!0,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"AI連携を有効にする"}),e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:l,onChange:o}),e.jsx("div",{className:`block w-12 h-7 rounded-full transition-colors ${l?"bg-brand-blue":"bg-gray-300"}`}),e.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform ${l?"translate-x-full":""}`})]})})]})}),e.jsxs(b,{title:"APIキー設定",defaultOpen:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gemini-key",className:"block text-sm font-medium text-gray-600 mb-1",children:"Google Gemini APIキー"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"gemini-key",type:P?"text":"password",value:O,onChange:a=>T(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md pr-10 bg-white text-gray-900",placeholder:"APIキーを入力"}),e.jsx("button",{type:"button",onClick:()=>be(!P),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500",children:P?e.jsx(Z,{className:"h-5 w-5"}):e.jsx(_,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"openai-key",className:"block text-sm font-medium text-gray-600 mb-1",children:"OpenAI APIキー"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"openai-key",type:$?"text":"password",value:G,onChange:a=>B(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md pr-10 bg-white text-gray-900",placeholder:"APIキーを入力"}),e.jsx("button",{type:"button",onClick:()=>ue(!$),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500",children:$?e.jsx(Z,{className:"h-5 w-5"}):e.jsx(_,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 text-sm rounded-r-lg",children:[e.jsx("p",{className:"font-semibold",children:"API利用に関するご注意"}),e.jsx("p",{className:"mt-1",children:"AI連携機能の利用は、各サービス（Google Gemini, OpenAI）の利用規約に基づき、別途料金が発生する場合があります。ご利用の際は、各サービスの料金体系を必ずご確認ください。"})]})]}),l&&e.jsxs("div",{className:"space-y-2 animate-fade-in",children:[e.jsx(b,{title:"AIプロバイダー選択",children:e.jsxs("div",{className:"flex bg-gray-200 rounded-lg p-1",children:[e.jsx(k,{name:"ai-provider",value:u.GEMINI,label:"Gemini",checked:s.aiProvider===u.GEMINI,onChange:()=>n("aiProvider",u.GEMINI)}),e.jsx(k,{name:"ai-provider",value:u.OPENAI,label:"OpenAI",checked:s.aiProvider===u.OPENAI,onChange:()=>n("aiProvider",u.OPENAI)})]})}),e.jsxs(b,{title:"AIアシスタント設定",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"起動時に活動履歴を自動チェック"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"アプリを開いた際にAIが活動履歴を分析し、更新を提案します。(Geminiのみ)"})]}),e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:!!s.aiAutoCheckActivities,onChange:()=>n("aiAutoCheckActivities",!s.aiAutoCheckActivities)}),e.jsx("div",{className:`block w-12 h-7 rounded-full transition-colors ${s.aiAutoCheckActivities?"bg-brand-blue":"bg-gray-300"}`}),e.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform ${s.aiAutoCheckActivities?"translate-x-full":""}`})]})})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"AIの応答を音声で読み上げる"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"AIチャットでAIからの返信を自動で読み上げます。"})]}),e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:!!s.aiVoiceResponse,onChange:()=>n("aiVoiceResponse",!s.aiVoiceResponse)}),e.jsx("div",{className:`block w-12 h-7 rounded-full transition-colors ${s.aiVoiceResponse?"bg-brand-blue":"bg-gray-300"}`}),e.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform ${s.aiVoiceResponse?"translate-x-full":""}`})]})})]})]})]})]});case"google":const x=D==null?void 0:D.currentUser.get().getBasicProfile(),I=async a=>{C(p=>({...p,[a.id]:"adding"})),await he(a)?C(p=>({...p,[a.id]:"success"})):(C(p=>({...p,[a.id]:"error"})),alert("Googleカレンダーへの登録に失敗しました。"),setTimeout(()=>C(p=>({...p,[a.id]:"idle"})),3e3))};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{title:"アカウント連携",description:"Googleアカウントと連携して、バックアップやカレンダー機能を利用します。",defaultOpen:!0,children:N?e.jsxs("div",{className:"p-4 border rounded-lg bg-green-50 border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:x==null?void 0:x.getImageUrl(),alt:"Google Profile",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:x==null?void 0:x.getName()}),e.jsx("p",{className:"text-sm text-gray-600",children:x==null?void 0:x.getEmail()})]})]}),e.jsx("button",{onClick:ce,className:"mt-4 w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"連携を解除"})]}):e.jsxs("div",{children:[e.jsx("button",{onClick:oe,disabled:!s.googleClientId,className:"w-full sm:w-auto px-6 py-2 font-semibold text-white bg-brand-blue rounded-md hover:bg-blue-800 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Googleアカウントと連携"}),!s.googleClientId&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:"連携するには、まず下の「連携設定」でGoogle Client IDを設定してください。"})]})}),e.jsxs(b,{title:"データバックアップ (Googleドライブ)",children:[e.jsx(y,{icon:e.jsx(De,{className:"h-5 w-5"}),label:"ドライブにバックアップ",description:R?"処理中...":f.checking?"最終バックアップ日時を確認中...":f.date?`最終: ${f.date}`:"バックアップはまだありません。",onClick:async()=>{w(!0),await me(),w(!1)},disabled:!N||R||f.checking}),e.jsx(y,{icon:e.jsx(Se,{className:"h-5 w-5"}),label:"ドライブから復元",description:"データをGoogleドライブから復元します。",onClick:async()=>{w(!0),await xe(),w(!1)},disabled:!N||R})]}),e.jsx(b,{title:"訪問予定のカレンダー同期",description:"登録されている訪問予定をワンクリックでGoogleカレンダーに追加できます。",children:e.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto border rounded-lg p-3 bg-white",children:K.length>0?K.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-yellow-50/50 rounded-md",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:a.name}),e.jsx("p",{className:"text-xs text-gray-600",children:a.followUpDate})]}),e.jsxs("button",{onClick:()=>I(a),disabled:!N||v[a.id]==="adding"||v[a.id]==="success",className:"flex items-center gap-1.5 px-2 py-1 text-xs bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:[v[a.id]==="success"?e.jsx(Ee,{className:"h-4 w-4 text-green-600"}):e.jsx(Oe,{className:"h-4 w-4"}),e.jsx("span",{children:v[a.id]==="success"?"登録済み":"追加"})]})]},a.id)):e.jsx("p",{className:"text-gray-500 text-center p-4 text-sm",children:"登録されている訪問予定はありません。"})})}),e.jsxs(b,{title:"連携設定",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"googleClientId",className:"block text-sm font-medium text-gray-600 mb-1",children:"Google Client ID"}),e.jsx("input",{id:"googleClientId",type:"text",value:s.googleClientId||"",onChange:a=>n("googleClientId",a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"Google Cloudで取得したClient ID"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"googleCalendarId",className:"block text-sm font-medium text-gray-600 mb-1",children:"Google Calendar ID"}),e.jsx("input",{id:"googleCalendarId",type:"text",value:s.googleCalendarId||"",onChange:a=>n("googleCalendarId",a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"（任意）primary"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"空欄の場合はメインカレンダーに登録されます。"})]})]})]});default:return null}},we=[{id:"profile",label:"プロフィール",icon:e.jsx(Ce,{className:"h-5 w-5"})},{id:"districts",label:"地区管理",icon:e.jsx(Ie,{className:"h-5 w-5"})},{id:"display",label:"表示設定",icon:e.jsx(_,{className:"h-5 w-5"})},{id:"data",label:"データ管理",icon:e.jsx(F,{className:"h-5 w-5"})},{id:"ai",label:"AI連携",icon:e.jsx(ke,{className:"h-5 w-5"})},{id:"google",label:"Google連携",icon:e.jsx(Ae,{className:"h-5 w-5"})}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"各種設定"}),e.jsx("button",{onClick:c,className:"text-gray-500 hover:text-gray-800",children:e.jsx(ve,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row flex-grow overflow-hidden",children:[e.jsx("nav",{className:"w-full md:w-48 p-2 border-b md:border-b-0 md:border-r overflow-x-auto md:overflow-y-auto",children:e.jsx("div",{className:"flex md:flex-col gap-1",children:we.map(l=>e.jsx(Ve,{icon:l.icon,label:l.label,isActive:L===l.id,onClick:()=>U(l.id)},l.id))})}),e.jsx("main",{className:"p-4 md:p-6 overflow-y-auto flex-grow bg-gray-50",children:fe()})]}),e.jsx("footer",{className:"flex justify-end items-center p-4 border-t bg-gray-100 rounded-b-lg",children:e.jsx("button",{onClick:c,className:"px-6 py-2 bg-brand-blue text-white rounded-md hover:bg-blue-800 transition-colors",children:"閉じる"})})]})})};export{ze as default};
